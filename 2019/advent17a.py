import ic
import os
import multiprocessing

def printscreen(m):
    #time.sleep(0.1)
    os.system('cls')
    for y in range(len(m)):
        print(''.join(m[y]))

if __name__ == '__main__':
    f = open('./2019/input17.txt')
    d = f.readline().split(',')
    d = list(map(int, d))
    d += [0 for x in range(50000)]
    #d[0] = 2 # for part2

    # init game process
    parent_conn, child_conn = multiprocessing.Pipe()
    icp = multiprocessing.Process(target=ic.intercode, args=(d, child_conn))
    icp.start()

    ss = ''
    screenline = ''
    while True:
        o = parent_conn.recv()


        #print(o, chr(o) if isinstance(o, int) else '')
        if (o == 'HALT'):
            break
        else:
            ss = ss + chr(o)
    icp.join()

    #ss = '..#..........'+chr(10)+'..#..........'+chr(10)+'#######...###'+chr(10)+'#.#...#...#.#'+chr(10)+\
    #     '#############'+chr(10)+'..#...#...#..'+chr(10)+'..#####...^..'

    print(ss)
    w = ss.index(chr(10))+1
    h = (len(ss)-1)//w
    print(w,h)


    # initialize board
    #block_cnt, score = 0, 0
    #ball_at, paddle_at = 99, 99
    #m = [['' for x in range(41)] for y in range(24)]


    ra = 0
    for i in range(len(ss)):
        if ((ss[i] == '#') and
            ((i-w > 0) and (ss[i-w] == '#')) and
            ((i+w < len(ss)-1) and (ss[i+w] == '#')) and
            ((i-1 > 0) and (ss[i-1] == '#')) and
            ((i+1 < len(ss)-1) and (ss[i+1] == '#'))):

            ra += (i//w)*(i%w)
    print('Part A', ra)


    x,y=0,0
    s = ss[y*w+x]



'''
..........................................#########......
..........................................#.......#......
..........................................#.......#......
..........................................#.......#......
..........................................#.......#......
..........................................#.......#......
..........................................#.......#......
..........................................#.......#......
......................................#############......
......................................#...#..............
......#.............................^######..............
......#...............................#..................
......#...............................#..................
......#...............................#..................
......#...............................#..................
......#...............................#..................
......#...............................#########..........
......#.......................................#..........
#######.................................#########........
#.......................................#.....#.#........
#.......................................#.....#.#........
#.......................................#.....#.#........
#.......................................#.....###########
#.......................................#.......#.......#
###########.............................#.......#.......#
..........#.............................#.......#.......#
..........#.............................###########.....#
..........#.....................................#.#.....#
..........#.....................................#.#.....#
..........#.....................................#.#.....#
..........#.....................................#########
..........#.......................................#......
..........###########.......................#######......
....................#.......................#............
....................#.............#########.#............
....................#.............#.......#.#............
....................#.............#.......#.#............
....................#.............#.......#.#............
....................#########.....#.......#.#............
............................#.....#.......#.#............
............................#.....#...#######............
............................#.....#...#...#..............
............................#.#############..............
............................#.#...#...#..................
............................#######...#..................
..............................#.......#..................
..............................#.......#..................
..............................#.......#..................
..............................#.......#..................
..............................#.......#..................
..............................#########..................
'''