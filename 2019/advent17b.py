import ic
import os
import multiprocessing

def printscreen(m):
    #time.sleep(0.1)
    os.system('cls')
    for y in range(len(m)):
        print(''.join(m[y]))

def send_cmd(parent_conn, cmd):
    for c in cmd:
        parent_conn.send(ord(c))
    parent_conn.send(10)

if __name__ == '__main__':
    f = open('./2019/input17.txt')
    d = f.readline().split(',')
    d = list(map(int, d))
    d += [0 for x in range(50000)]
    d[0] = 2 # for part2

    # init game process
    parent_conn, child_conn = multiprocessing.Pipe()
    icp = multiprocessing.Process(target=ic.intercode, args=(d, child_conn))
    icp.start()


    screenline = ''
    while True:
        o = parent_conn.recv()
        if (o == 'HALT'):
            break
        elif (o == 10):
            print(screenline)
            if (screenline == ''):
                os.system('cls')
            if (screenline == 'Main:'):
                send_cmd(parent_conn,'A,B,A,B,C,A,B,C,A,C')
            elif (screenline == 'Function A:'):
                send_cmd(parent_conn,'R,6,L,10,R,8')
            elif (screenline == 'Function B:'):
                send_cmd(parent_conn,'R,8,R,12,L,8,L,8')
            elif (screenline == 'Function C:'):
                send_cmd(parent_conn,'L,10,R,6,R,6,L,8')
            elif (screenline == 'Continuous video feed?'):
                send_cmd(parent_conn,'n')
            screenline = ''
        elif o < 500:
            screenline = screenline + chr(o)
        else:
            print(o)

    icp.join()

'''
..........................................#########......
..........................................#.......#......
..........................................#.......#......
..........................................#.......#......
..........................................#.......#......
..........................................#.......#......
..........................................#.......#......
..........................................#.......#......
......................................#############......
......................................#...#..............
......#.............................^######..............
......#...............................#..................
......#...............................#..................
......#...............................#..................
......#...............................#..................
......#...............................#..................
......#...............................#########..........
......#.......................................#..........
#######.................................#########........
#.......................................#.....#.#........
#.......................................#.....#.#........
#.......................................#.....#.#........
#.......................................#.....###########
#.......................................#.......#.......#
###########.............................#.......#.......#
..........#.............................#.......#.......#
..........#.............................###########.....#
..........#.....................................#.#.....#
..........#.....................................#.#.....#
..........#.....................................#.#.....#
..........#.....................................#########
..........#.......................................#......
..........###########.......................#######......
....................#.......................#............
....................#.............#########.#............
....................#.............#.......#.#............
....................#.............#.......#.#............
....................#.............#.......#.#............
....................#########.....#.......#.#............
............................#.....#.......#.#............
............................#.....#...#######............
............................#.....#...#...#..............
............................#.#############..............
............................#.#...#...#..................
............................#######...#..................
..............................#.......#..................
..............................#.......#..................
..............................#.......#..................
..............................#.......#..................
..............................#.......#..................
..............................#########..................
'''